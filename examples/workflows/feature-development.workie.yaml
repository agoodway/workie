# Workie Workflow for Feature Branch Development

# This template provides a typical workflow for developing features in isolated branches.
# It is easily adaptable for teams practicing Git flow or trunk-based development.

name: "Feature Branch Development"
description: "A workflow for developing, testing, and merging new features"

env:
  NODE_ENV: "development"
  FEATURE: "Feature_Name"

# Workflow tasks
workflow:
  feature:checkout:
    description: "Switch to a new feature branch"
    commands:
      - "git checkout -b feature/$FEATURE"

  feature:sync:
    description: "Sync feature branch with the latest from main"
    commands:
      - "git checkout main"
      - "git pull origin main"
      - "git checkout feature/$FEATURE"
      - "git merge main"

  feature:develop:
    description: "Develop new feature"
    commands:
      - "workie run install"
      - "workie run dev"
    depends_on: ["feature:sync"]

  feature:test:
    description: "Test feature"
    commands:
      - "workie run lint"
      - "workie run test"

  feature:document:
    description: "Document feature changes"
    commands:
      - "echo 'Documenting feature changes for $FEATURE'"

  feature:commit:
    description: "Commit changes"
    commands:
      - "git add ."
      - "git commit -m 'Develop feature $FEATURE'"

  feature:push:
    description: "Push feature to remote repository"
    commands:
      - "git push -u origin feature/$FEATURE"

  feature:pr:
    description: "Create a pull request"
    commands:
      - "gh pr create --base main --head feature/$FEATURE --title 'Feature: $FEATURE' --body 'Describing the feature changes made'"
    depends_on: ["feature:push"]

  feature:review:
    description: "Review feature pull request"
    commands:
      - "echo 'Requesting peer review for feature $FEATURE'"

  feature:merge:
    description: "Merge feature once approved"
    commands:
      - "gh pr merge feature/$FEATURE --squash"

# Hooks for development
hooks:
  pre-commit:
    - "workie run feature:test"
    - "workie run feature:document"
  
  pre-push:
    - "workie run feature:test"

# Documentation
docs:
  feature_branch: |
    ## Feature Branch Development
    
    1. Start a new feature: `workie run feature:checkout`
    2. Sync with main: `workie run feature:sync`
    3. Develop feature: `workie run feature:develop`
    4. Test feature: `workie run feature:test`
    5. Commit changes: `workie run feature:commit`
    6. Push to remote: `workie run feature:push`
    7. Open a PR: `workie run feature:pr`
    8. Await review: `workie run feature:review`
    9. Merge when ready: `workie run feature:merge`
